---
// src/pages/waitlist.astro
import BaseLayout from '../../layouts/BaseLayout.astro';

// Page-specific metadata
const title = "Join Our Waiting List - Amiquus";
const description = "Join our waiting list to be notified when new subscription slots become available for our car listing monitoring service.";

// Props for BaseLayout - placeholders for now.
const languageIso = "en";
const countryCode = "US";
const contentOrientation = "ltr";
const languageLinksMap: Record<string, string> = { 'en': '/en', 'de': '/de' };
---

<BaseLayout
  languageIso={languageIso}
  countryCode={countryCode}
  contentOrientation={contentOrientation}
  title={title}
  description={description}
  languageLinksMap={languageLinksMap}
>
  <main class="py-20 sm:py-32">
    <div class="max-w-screen-xl mx-auto px-4">
      <div class="max-w-3xl mx-auto">
        <!-- Page Header -->
        <div class="text-center mb-12">
          <h1 class="text-4xl lg:text-5xl font-bold text-foreground mb-4 animate-on-scroll">
            Join Our <span class="text-primary">Waiting List</span>
          </h1>
          <p class="text-lg text-muted-foreground animate-on-scroll" data-delay="100">
            We're currently at full capacity, but we'll notify you as soon as a spot becomes available.
          </p>
        </div>

        <!-- Capacity Indicator -->
        <div class="bg-card border-2 border-destructive rounded-xl p-8 mb-12 shadow-lg animate-on-scroll" data-delay="200">
          <div class="text-center mb-6">
            <h2 class="text-2xl font-bold text-destructive mb-2">⚠️ Limited Capacity Reached</h2>
            <p class="text-muted-foreground">
              We intentionally limit our service to 30 active subscribers to maintain the competitive advantage for our users. Currently, all spots are taken.
            </p>
          </div>
          <div class="flex justify-between items-center mb-4 text-sm font-semibold text-destructive">
            <span><strong>30</strong> active subscribers</span>
            <span><strong>0</strong> spots available</span>
          </div>
          <div class="w-full h-4 bg-muted rounded-full overflow-hidden mb-4">
            <div id="capacity-progress" class="h-full bg-gradient-to-r from-destructive to-amber-500 rounded-full transition-all duration-1000 ease-out" style="width: 0%;"></div>
          </div>
          <p class="text-center font-semibold text-destructive text-sm">
            <strong>100% Full</strong> - Join our waiting list to be notified!
          </p>
        </div>

        <!-- Benefits Section -->
        <div class="bg-primary/10 border border-primary/20 rounded-xl p-6 mb-12 animate-on-scroll" data-delay="300">
          <h3 class="text-xl font-semibold text-primary mb-4">Why Join Our Waiting List?</h3>
          <ul class="space-y-3">
            <li class="flex items-start gap-3 text-foreground text-sm">
              <div class="w-5 h-5 bg-success rounded-full flex items-center justify-center text-success-foreground flex-shrink-0 mt-0.5">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg>
              </div>
              <span>Get priority access when new spots become available</span>
            </li>
            <li class="flex items-start gap-3 text-foreground text-sm">
              <div class="w-5 h-5 bg-success rounded-full flex items-center justify-center text-success-foreground flex-shrink-0 mt-0.5">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg>
              </div>
              <span>Receive instant email notifications when capacity opens</span>
            </li>
            <li class="flex items-start gap-3 text-foreground text-sm">
              <div class="w-5 h-5 bg-success rounded-full flex items-center justify-center text-success-foreground flex-shrink-0 mt-0.5">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg>
              </div>
              <span>No commitment - join the list for free</span>
            </li>
          </ul>
        </div>
        
        <!-- Success Message (hidden by default) -->
        <div id="success-message" class="bg-success/10 border border-success/20 text-success p-8 rounded-xl text-center hidden animate-on-scroll">
          <div class="w-12 h-12 bg-success rounded-full flex items-center justify-center mx-auto mb-4 text-success-foreground">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
          </div>
          <h3 class="text-xl font-semibold mb-2">You're on the list!</h3>
          <p>Thank you for joining. We'll notify you via email as soon as a subscription spot becomes available.</p>
        </div>

        <!-- Waiting List Form Container -->
        <div id="waitlist-form-container" class="bg-card border border-border rounded-xl p-8 shadow-lg animate-on-scroll" data-delay="400">
          <h2 class="text-2xl font-bold text-foreground mb-2">Join the Waiting List</h2>
          <p class="text-muted-foreground mb-6">
            Enter your details below and we'll notify you immediately when a subscription spot becomes available.
          </p>

          <div id="error-message" class="bg-destructive/10 border border-destructive/20 text-destructive p-4 rounded-md mb-6 text-sm hidden"></div>

          <form id="waitlist-form" class="space-y-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="text-start">
                <label for="first-name" class="block text-sm font-medium text-foreground mb-1">First Name</label>
                <input type="text" id="first-name" name="firstName" class="w-full px-3 py-2 rounded-md border border-input bg-background text-foreground focus:border-primary focus:ring-1 focus:ring-primary" placeholder="John" required>
                <div id="first-name-error" class="text-destructive text-xs mt-1 hidden"></div>
              </div>
              <div class="text-start">
                <label for="last-name" class="block text-sm font-medium text-foreground mb-1">Last Name</label>
                <input type="text" id="last-name" name="lastName" class="w-full px-3 py-2 rounded-md border border-input bg-background text-foreground focus:border-primary focus:ring-1 focus:ring-primary" placeholder="Doe" required>
                <div id="last-name-error" class="text-destructive text-xs mt-1 hidden"></div>
              </div>
            </div>
            <div class="text-start">
              <label for="email" class="block text-sm font-medium text-foreground mb-1">Email Address</label>
              <input type="email" id="email" name="email" class="w-full px-3 py-2 rounded-md border border-input bg-background text-foreground focus:border-primary focus:ring-1 focus:ring-primary" placeholder="john@example.com" required>
              <div id="email-error" class="text-destructive text-xs mt-1 hidden"></div>
            </div>
            <div class="text-start">
              <label for="phone" class="block text-sm font-medium text-foreground mb-1">Phone Number (Optional)</label>
              <input type="tel" id="phone" name="phone" class="w-full px-3 py-2 rounded-md border border-input bg-background text-foreground focus:border-primary focus:ring-1 focus:ring-primary" placeholder="+1 (555) 123-4567">
              <div id="phone-error" class="text-destructive text-xs mt-1 hidden"></div>
            </div>
            <div class="text-start">
              <label for="interest" class="block text-sm font-medium text-foreground mb-1">What type of cars are you interested in? (Optional)</label>
              <input type="text" id="interest" name="interest" class="w-full px-3 py-2 rounded-md border border-input bg-background text-foreground focus:border-primary focus:ring-1 focus:ring-primary" placeholder="e.g., BMW 3 Series, Mercedes C-Class">
            </div>
            <button type="submit" id="submit-btn" class="w-full flex items-center justify-center px-6 py-3 rounded-lg font-semibold bg-primary text-primary-foreground hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed">
              <span id="submit-text">Join Waiting List</span>
              <span id="submit-loading" class="hidden ms-2"><div class="w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"></div></span>
            </button>
            <p class="text-center text-xs text-muted-foreground pt-2">
              We'll only contact you when a subscription spot becomes available. No spam, ever.
            </p>
          </form>
        </div>
      </div>
    </div>
  </main>
</BaseLayout>