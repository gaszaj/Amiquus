---
// src/components/Cookie.astro

// --- All text is hardcoded as requested ---
const title = 'We value your privacy';
const description = 'We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies.';
const linkText = 'Read our Cookie Policy';
const policyUrl = `/cookie-policy`; // Assumes a generic, non-localized URL for now
const buttonAcceptAll = 'Accept All';
const buttonCustomize = 'Customize';
const buttonDecline = 'Decline';
const ariaClose = 'Close cookie settings';
const ariaOpenSettings = 'Open cookie settings';
const customizeTitle = 'Customize Consent Preferences';
const customizeDescription = 'We use cookies to help our website work, to understand how it is used, and to tailor advertising. You can read more in our cookie policy and make your choices below. By clicking "Save Preferences" you are giving your consent to our use of cookies.';
const buttonSave = 'Save Preferences';
const essentialTitle = 'Strictly Necessary Cookies';
const essentialDesc = 'These cookies are essential for the website to function and cannot be switched off in our systems. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms.';
const analyticsTitle = 'Analytics Cookies';
const analyticsDesc = 'These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site.';
const marketingTitle = 'Marketing Cookies';
const marketingDesc = 'These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites.';
const alwaysActiveLabel = 'Always Active';
---

<div id="cookie-container" class="fixed bottom-4 start-4 z-[9999]">
  <!-- Floating settings icon -->
  <button id="cookie-settings-trigger" class="hidden h-12 w-12 bg-card border border-border rounded-full flex items-center justify-center shadow-lg transition-transform duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background" aria-label={ariaOpenSettings}>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="text-primary"><g fill="currentColor" fill-opacity="0" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="56" stroke-dashoffset="56" d="M12 4c-4.42 0 -8 3.58 -8 8c0 4.42 3.58 8 8 8c4.42 0 8 -3.58 8 -8v-1h-2c-0.55 0 -1 -0.45 -1 -1v-1h-2c-0.55 0 -1 -0.45 -1 -1v-1h-1c-0.55 0 -1 -0.45 -1 -1Z"><animate fill="freeze" attributeName="fill-opacity" begin="0.84s" dur="0.18s" values="0;0.25"/><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.72s" values="56;0"/></path><g stroke="none"><circle cx="9.5" cy="7.5" r="1.5"><animate fill="freeze" attributeName="fill-opacity" begin="1.08s" dur="0.24s" values="0;1"/></circle><circle cx="11" cy="17.5" r="1.5"><animate fill="freeze" attributeName="fill-opacity" begin="1.2s" dur="0.24s" values="0;1"/></circle><circle cx="6.5" cy="11.5" r="1.5"><animate fill="freeze" attributeName="fill-opacity" begin="1.32s" dur="0.24s" values="0;1"/></circle><circle cx="16.5" cy="14.5" r="1.5"><animate fill="freeze" attributeName="fill-opacity" begin="1.44s" dur="0.24s" values="0;1"/></circle><circle cx="11.5" cy="12.5" r="1.5"><animate fill="freeze" attributeName="fill-opacity" begin="1.56s" dur="0.24s" values="0;1"/></circle></g></g></svg>
  </button>
  
  <!-- Main Banner -->
  <div id="cookie-consent-banner" class="fixed bottom-0 inset-x-0 p-4 bg-card text-foreground border-t border-border shadow-[0_-5px_15px_rgba(0,0,0,0.1)] dark:shadow-[0_-5px_15px_rgba(0,0,0,0.3)] transition-transform duration-500 ease-in-out transform translate-y-full" role="dialog" aria-live="polite" aria-label={title} aria-describedby="cookie-description">
    
    <!-- Initial View (Accept/Decline) -->
    <div id="cookie-initial-view">
      <div class="max-w-screen-xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="text-sm md:flex-grow text-center md:text-start">
          <h2 class="font-bold text-lg mb-1 text-primary">{title}</h2>
          <p id="cookie-description" class="text-muted-foreground">{description} <a href={policyUrl} class="underline hover:text-primary transition-colors">{linkText}</a>.</p>
        </div>
        <div class="flex-shrink-0 w-full md:w-auto flex flex-col sm:flex-row gap-2 mt-4 md:mt-0">
          <button id="cookie-accept-btn" class="w-full sm:w-auto px-6 py-2 bg-primary text-primary-foreground font-bold border border-primary hover:opacity-90 transition-all rounded-md">{buttonAcceptAll}</button>
          <button id="cookie-customize-btn" class="w-full sm:w-auto px-6 py-2 bg-secondary text-secondary-foreground font-bold border border-border hover:bg-border transition-all rounded-md">{buttonCustomize}</button>
          <button id="cookie-decline-btn" class="w-full sm:w-auto px-6 py-2 bg-transparent text-muted-foreground font-bold border border-border hover:bg-border transition-all rounded-md">{buttonDecline}</button>
        </div>
      </div>
    </div>
    
    <!-- Details View (Customize) -->
    <div id="cookie-details-view" class="hidden">
      <div class="max-w-screen-xl mx-auto max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-start mb-4">
          <div class="text-start">
            <h2 class="font-bold text-lg text-primary">{customizeTitle}</h2>
            <p class="text-sm text-muted-foreground max-w-3xl">{customizeDescription}</p>
          </div>
          <button id="cookie-close-details-btn" class="p-1 text-muted-foreground hover:text-foreground" aria-label={ariaClose}>
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
          </button>
        </div>
        <div class="space-y-4 border-t border-b border-border py-4 my-4">
          <div class="flex justify-between items-start gap-4 py-2">
            <div class="text-start">
              <h3 class="font-semibold text-foreground">{essentialTitle}</h3>
              <p class="text-sm text-muted-foreground">{essentialDesc}</p>
            </div>
            <div class="flex-shrink-0 ms-4 pt-1">
              <span class="inline-block px-3 py-1 text-xs font-medium text-primary bg-primary/10 rounded-full">{alwaysActiveLabel}</span>
            </div>
          </div>
          <div class="border-t border-border/50 flex justify-between items-start gap-4 py-3">
            <div class="text-start">
              <h3 class="font-semibold text-foreground">{analyticsTitle}</h3>
              <p class="text-sm text-muted-foreground">{analyticsDesc}</p>
            </div>
            <div class="flex-shrink-0 ms-4 pt-1">
              <label for="cookie-analytics" class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="cookie-analytics" class="sr-only peer" checked>
                <div class="w-11 h-6 bg-border rounded-full peer peer-focus:ring-2 peer-focus:ring-primary/50 peer-checked:bg-primary peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-card after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-card after:border-border after:border after:rounded-full after:h-5 after:w-5 after:transition-all"></div>
              </label>
            </div>
          </div>
          <div class="border-t border-border/50 flex justify-between items-start gap-4 py-3">
            <div class="text-start">
              <h3 class="font-semibold text-foreground">{marketingTitle}</h3>
              <p class="text-sm text-muted-foreground">{marketingDesc}</p>
            </div>
            <div class="flex-shrink-0 ms-4 pt-1">
              <label for="cookie-marketing" class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="cookie-marketing" class="sr-only peer" checked>
                <div class="w-11 h-6 bg-border rounded-full peer peer-focus:ring-2 peer-focus:ring-primary/50 peer-checked:bg-primary peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-card after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-card after:border-border after:border after:rounded-full after:h-5 after:w-5 after:transition-all"></div>
              </label>
            </div>
          </div>
        </div>
        <div class="flex flex-col sm:flex-row gap-2">
          <button id="cookie-save-prefs-btn" class="px-6 py-2 bg-primary text-primary-foreground font-bold border border-primary hover:opacity-90 transition-all rounded-md">{buttonSave}</button>
          <button id="cookie-accept-all-details-btn" class="px-6 py-2 bg-secondary text-secondary-foreground font-bold border border-border hover:bg-border transition-all rounded-md">{buttonAcceptAll}</button>
        </div>
      </div>
    </div>
  </div>
</div>